<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GraphQL Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        .result {
            white-space: pre-wrap;
            background: #f4f4f4;
            padding: 10px;
            border: 1px solid #ccc;
            margin-top: 10px;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>GraphQL Test</h1>
    <div>
        <h2>Add Author</h2>
        <input type="text" id="authorName" placeholder="Author Name">
        <button onclick="addAuthor()">Add Author</button>
    </div>
    <div>
        <h2>Add Book</h2>
        <input type="text" id="bookTitle" placeholder="Book Title">
        <input type="number" id="authorId" placeholder="Author ID">
        <button onclick="addBook()">Add Book</button>
    </div>
    <div>
        <h2>Get All Authors</h2>
        <button onclick="getAllAuthors()">Get All Authors</button>
    </div>
    <div>
        <h2>Get All Books</h2>
        <button onclick="getAllBooks()">Get All Books</button>
    </div>
    <div class="result" id="result"></div>
</div>

<script>
    const graphqlEndpoint = '/graphql';

    async function fetchGraphQL(query, variables = {}) {
        const response = await fetch(graphqlEndpoint, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                query,
                variables,
            }),
        });
        return response.json();
    }

    async function addAuthor() {
        const name = document.getElementById('authorName').value;
        const query = `
                mutation ($name: String!) {
                    addAuthor(name: $name) {
                        id
                        name
                    }
                }
            `;
        const variables = { name };
        const result = await fetchGraphQL(query, variables);
        document.getElementById('result').innerText = JSON.stringify(result, null, 2);
    }

    async function addBook() {
        const title = document.getElementById('bookTitle').value;
        const authorId = parseInt(document.getElementById('authorId').value);
        const query = `
                mutation ($title: String!, $authorId: ID!) {
                    addBook(title: $title, authorId: $authorId) {
                        id
                        title
                        author {
                            id
                            name
                        }
                    }
                }
            `;
        const variables = { title, authorId };
        const result = await fetchGraphQL(query, variables);
        document.getElementById('result').innerText = JSON.stringify(result, null, 2);
    }

    async function getAllAuthors() {
        const query = `
                query {
                    allAuthors {
                        id
                        name
                    }
                }
            `;
        const result = await fetchGraphQL(query);
        document.getElementById('result').innerText = JSON.stringify(result, null, 2);
    }

    async function getAllBooks() {
        const query = `
                query {
                    allBooks {
                        id
                        title
                        author {
                            id
                            name
                        }
                    }
                }
            `;
        const result = await fetchGraphQL(query);
        document.getElementById('result').innerText = JSON.stringify(result, null, 2);
    }
</script>
</body>
</html>
